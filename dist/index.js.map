{"version":3,"file":"index.js","sources":["../src/components/Menu.tsx","../src/components/Input.tsx","../src/components/MultiSelect.tsx","../src/components/ProjectInfo.tsx","../src/services/parser.ts","../src/config/dependencies.ts","../src/services/generator.ts","../src/app.tsx","../src/index.tsx"],"sourcesContent":["import React, { useState } from 'react'\r\nimport { Box, Text, useInput } from 'ink'\r\n\r\ninterface MenuProps {\r\n  items: string[]\r\n  onSelect: (index: number) => void\r\n  onBack?: () => void\r\n}\r\n\r\nexport function Menu({ items, onSelect, onBack }: MenuProps) {\r\n  const [selectedIndex, setSelectedIndex] = useState(0)\r\n\r\n  useInput((input, key) => {\r\n    if (input === 'j' || key.downArrow) {\r\n      setSelectedIndex(prev => (prev + 1) % items.length)\r\n    } else if (input === 'k' || key.upArrow) {\r\n      setSelectedIndex(prev => (prev - 1 + items.length) % items.length)\r\n    } else if (key.return) {\r\n      onSelect(selectedIndex)\r\n    } else if (input === 'b' && onBack) {\r\n      onBack()\r\n    }\r\n  })\r\n\r\n  return (\r\n    <Box flexDirection=\"column\">\r\n      {items.map((item, index) => (\r\n        <Box key={index}>\r\n          <Text color={index === selectedIndex ? 'green' : undefined}>\r\n            {index === selectedIndex ? '> ' : '  '}\r\n            {item}\r\n          </Text>\r\n        </Box>\r\n      ))}\r\n    </Box>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Box, Text, useInput } from 'ink'\r\n\r\ninterface InputProps {\r\n  label: string\r\n  placeholder?: string\r\n  defaultValue?: string\r\n  isPassword?: boolean\r\n  onSubmit: (value: string) => void\r\n  onBack?: () => void\r\n}\r\n\r\nexport function Input({\r\n  label,\r\n  placeholder = '',\r\n  defaultValue = '',\r\n  isPassword = false,\r\n  onSubmit,\r\n  onBack\r\n}: InputProps) {\r\n  const [value, setValue] = useState(defaultValue)\r\n  const [cursorPosition, setCursorPosition] = useState(defaultValue.length)\r\n\r\n  useInput((input, key) => {\r\n    if (key.return) {\r\n      onSubmit(value)\r\n    } else if (input === 'b' && key.ctrl && onBack) {\r\n      onBack()\r\n    } else if (key.backspace || key.delete) {\r\n      if (cursorPosition > 0) {\r\n        setValue(prev => prev.slice(0, cursorPosition - 1) + prev.slice(cursorPosition))\r\n        setCursorPosition(prev => prev - 1)\r\n      }\r\n    } else if (key.leftArrow) {\r\n      setCursorPosition(prev => Math.max(0, prev - 1))\r\n    } else if (key.rightArrow) {\r\n      setCursorPosition(prev => Math.min(value.length, prev + 1))\r\n    } else if (!key.ctrl && !key.meta && input) {\r\n      setValue(prev => prev.slice(0, cursorPosition) + input + prev.slice(cursorPosition))\r\n      setCursorPosition(prev => prev + input.length)\r\n    }\r\n  })\r\n\r\n  const displayValue = isPassword ? '*'.repeat(value.length) : value\r\n  const displayWithCursor = displayValue.slice(0, cursorPosition) + '█' + displayValue.slice(cursorPosition)\r\n\r\n  return (\r\n    <Box flexDirection=\"column\">\r\n      <Text>{label}</Text>\r\n      <Box>\r\n        <Text color=\"green\">&gt; </Text>\r\n        <Text>\r\n          {value ? displayWithCursor : <Text dimColor>{placeholder}█</Text>}\r\n        </Text>\r\n      </Box>\r\n      <Box marginTop={1}>\r\n        <Text dimColor>Enter 确认 | Ctrl+B 返回</Text>\r\n      </Box>\r\n    </Box>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Box, Text, useInput } from 'ink'\r\nimport type { AdDependency } from '../types.js'\r\n\r\ninterface MultiSelectProps {\r\n  label: string\r\n  items: AdDependency[]\r\n  onSubmit: (items: AdDependency[]) => void\r\n  onBack?: () => void\r\n}\r\n\r\nexport function MultiSelect({ label, items, onSubmit, onBack }: MultiSelectProps) {\r\n  const [selectedIndex, setSelectedIndex] = useState(0)\r\n  const [selections, setSelections] = useState<AdDependency[]>(items)\r\n\r\n  useInput((input, key) => {\r\n    if (input === 'j' || key.downArrow) {\r\n      setSelectedIndex(prev => (prev + 1) % selections.length)\r\n    } else if (input === 'k' || key.upArrow) {\r\n      setSelectedIndex(prev => (prev - 1 + selections.length) % selections.length)\r\n    } else if (input === ' ') {\r\n      setSelections(prev =>\r\n        prev.map((item, index) =>\r\n          index === selectedIndex ? { ...item, selected: !item.selected } : item\r\n        )\r\n      )\r\n    } else if (key.return) {\r\n      onSubmit(selections)\r\n    } else if (input === 'b' && onBack) {\r\n      onBack()\r\n    }\r\n  })\r\n\r\n  return (\r\n    <Box flexDirection=\"column\">\r\n      <Text>{label}</Text>\r\n      <Box flexDirection=\"column\" marginTop={1}>\r\n        {selections.map((item, index) => (\r\n          <Box key={item.id}>\r\n            <Text color={index === selectedIndex ? 'green' : undefined}>\r\n              {index === selectedIndex ? '> ' : '  '}\r\n              [{item.selected ? 'x' : ' '}] {item.name}\r\n            </Text>\r\n          </Box>\r\n        ))}\r\n      </Box>\r\n    </Box>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Box, Text, useInput } from 'ink'\r\nimport type { ProjectInfo } from '../types.js'\r\n\r\ninterface ProjectInfoDisplayProps {\r\n  info: ProjectInfo\r\n  onConfirm: () => void\r\n  onBack?: () => void\r\n}\r\n\r\nexport function ProjectInfoDisplay({ info, onConfirm, onBack }: ProjectInfoDisplayProps) {\r\n  useInput((input, key) => {\r\n    if (key.return) {\r\n      onConfirm()\r\n    } else if (input === 'b' && onBack) {\r\n      onBack()\r\n    }\r\n  })\r\n\r\n  const moduleList = info.modules.slice(0, 5).join(', ')\r\n  const moreModules = info.modules.length > 5 ? ` 等 ${info.modules.length} 个模块` : ''\r\n\r\n  return (\r\n    <Box flexDirection=\"column\">\r\n      <Text bold>项目信息</Text>\r\n      <Box flexDirection=\"column\" marginTop={1} marginLeft={2}>\r\n        <Box borderStyle=\"round\" flexDirection=\"column\" paddingX={2} paddingY={1}>\r\n          <Text>应用名称: <Text color=\"green\">{info.name}</Text></Text>\r\n          <Text>应用ID: <Text color=\"green\">{info.id}</Text></Text>\r\n          <Text>版本: <Text color=\"green\">{info.versionName} ({info.versionCode})</Text></Text>\r\n          <Text>模块: <Text color=\"green\">{moduleList}{moreModules}</Text></Text>\r\n        </Box>\r\n      </Box>\r\n      <Box marginTop={1}>\r\n        <Text dimColor>Enter 继续 | b 返回</Text>\r\n      </Box>\r\n    </Box>\r\n  )\r\n}\r\n","import fs from 'fs-extra'\r\nimport path from 'path'\r\nimport type { ProjectInfo } from '../types.js'\r\n\r\n/**\r\n * 标准化路径，处理 Git Bash (MINGW64) 风格的路径\r\n * 例如: /d/workspace/driver -> D:\\workspace\\driver\r\n */\r\nfunction normalizePath(inputPath: string): string {\r\n  // 处理 Git Bash 路径格式: /d/... 或 /D/...\r\n  if (process.platform === 'win32' && /^\\/[a-zA-Z]\\//.test(inputPath)) {\r\n    const driveLetter = inputPath[1].toUpperCase()\r\n    return `${driveLetter}:${inputPath.slice(2).replace(/\\//g, '\\\\')}`\r\n  }\r\n  // 返回原始路径（可能已经是正确格式）\r\n  return path.resolve(inputPath)\r\n}\r\n\r\ninterface ManifestJson {\r\n  id: string\r\n  name: string\r\n  version: {\r\n    name: string\r\n    code: number\r\n  }\r\n  'app-android'?: {\r\n    distribute?: {\r\n      modules?: Record<string, unknown>\r\n      icons?: Record<string, string>\r\n    }\r\n  }\r\n}\r\n\r\nexport async function parseProject(hbuilderxPath: string): Promise<ProjectInfo> {\r\n  // 标准化路径（处理 Git Bash 格式）\r\n  const normalizedPath = normalizePath(hbuilderxPath)\r\n  // 拼接产物路径\r\n  const outputPath = path.join(normalizedPath, 'unpackage', 'resources', 'app-android')\r\n\r\n  // 检查路径是否存在\r\n  if (!await fs.pathExists(outputPath)) {\r\n    throw new Error(`找不到 HBuilderX 产物目录: ${outputPath}`)\r\n  }\r\n\r\n  // 查找 manifest.json\r\n  const manifestPath = await findManifest(outputPath)\r\n  if (!manifestPath) {\r\n    throw new Error('找不到 manifest.json 文件')\r\n  }\r\n\r\n  // 读取并解析 manifest.json\r\n  const manifestContent = await fs.readFile(manifestPath, 'utf-8')\r\n  const manifest: ManifestJson = JSON.parse(manifestContent)\r\n\r\n  // 提取模块列表\r\n  const modules = manifest['app-android']?.distribute?.modules\r\n    ? Object.keys(manifest['app-android'].distribute.modules)\r\n    : []\r\n\r\n  // 提取图标配置\r\n  const icons = manifest['app-android']?.distribute?.icons || {}\r\n\r\n  return {\r\n    id: manifest.id,\r\n    name: manifest.name,\r\n    versionName: manifest.version.name,\r\n    versionCode: manifest.version.code,\r\n    modules,\r\n    icons,\r\n  }\r\n}\r\n\r\nasync function findManifest(basePath: string): Promise<string | null> {\r\n  // 尝试直接在根目录查找\r\n  const directPath = path.join(basePath, 'manifest.json')\r\n  if (await fs.pathExists(directPath)) {\r\n    return directPath\r\n  }\r\n\r\n  // 遍历子目录查找 (通常在 __UNI__xxx/www/manifest.json)\r\n  const entries = await fs.readdir(basePath, { withFileTypes: true })\r\n  for (const entry of entries) {\r\n    if (entry.isDirectory() && entry.name.startsWith('__UNI__')) {\r\n      const wwwManifest = path.join(basePath, entry.name, 'www', 'manifest.json')\r\n      if (await fs.pathExists(wwwManifest)) {\r\n        return wwwManifest\r\n      }\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nexport function getOutputPath(hbuilderxPath: string): string {\r\n  const normalizedPath = normalizePath(hbuilderxPath)\r\n  return path.join(normalizedPath, 'unpackage', 'resources', 'app-android')\r\n}\r\n","// 必须依赖 (19个基础依赖)\r\nexport const requiredDependencies = [\r\n  'implementation \"androidx.core:core-ktx:1.10.1\"',\r\n  'implementation \"androidx.recyclerview:recyclerview:1.3.2\"',\r\n  'implementation \"androidx.appcompat:appcompat:1.6.1\"',\r\n  'implementation \"androidx.exifinterface:exifinterface:1.3.6\"',\r\n  'implementation \"androidx.localbroadcastmanager:localbroadcastmanager:1.0.0@aar\"',\r\n  'implementation \"androidx.constraintlayout:constraintlayout:2.1.4\"',\r\n  'implementation \"androidx.webkit:webkit:1.6.0\"',\r\n  'implementation \"com.google.android.material:material:1.4.0\"',\r\n  'implementation \"androidx.viewpager2:viewpager2:1.1.0-beta02\"',\r\n  'implementation \"com.alibaba:fastjson:1.2.83\"',\r\n  'implementation \"com.facebook.fresco:fresco:3.4.0\"',\r\n  'implementation \"com.facebook.fresco:middleware:3.4.0\"',\r\n  'implementation \"com.facebook.fresco:animated-gif:3.4.0\"',\r\n  'implementation \"com.facebook.fresco:webpsupport:3.4.0\"',\r\n  'implementation \"com.facebook.fresco:animated-webp:3.4.0\"',\r\n  'implementation \"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.4\"',\r\n  'implementation \"org.jetbrains.kotlinx:kotlinx-coroutines-android:1.6.4\"',\r\n  'implementation \"org.jetbrains.kotlin:kotlin-stdlib:2.2.0\"',\r\n  'implementation \"org.jetbrains.kotlin:kotlin-reflect:2.2.0\"',\r\n]\r\n\r\n// 广告依赖映射\r\nexport const adDependencies: Record<string, string[]> = {\r\n  huawei: [\r\n    'implementation \"com.huawei.hms:ads-lite:13.4.66.300\"',\r\n  ],\r\n  csj: [\r\n    'implementation \"com.pangle.cn:ads-sdk:6.3.0.0\"',\r\n  ],\r\n  gdt: [\r\n    'implementation \"com.qq.e.union:union:4.610.1460\"',\r\n  ],\r\n  ks: [\r\n    'implementation \"com.github.nicehcy:KSAdSDK:3.3.68.2\"',\r\n  ],\r\n  baidu: [\r\n    'implementation \"com.baidu.mobads:sdk:9.37\"',\r\n  ],\r\n  sigmob: [\r\n    'implementation \"com.sigmob.windad:sdk:4.18.0\"',\r\n  ],\r\n  unity: [\r\n    'implementation \"com.unity3d.ads:unity-ads:4.12.4\"',\r\n  ],\r\n  vungle: [\r\n    'implementation \"com.vungle:publisher-sdk-android:7.4.2\"',\r\n  ],\r\n  mintegral: [\r\n    'implementation \"com.mintegral.msdk:mtgdownloads:16.8.41\"',\r\n  ],\r\n  ironsource: [\r\n    'implementation \"com.ironsource.sdk:mediationsdk:8.4.0\"',\r\n  ],\r\n}\r\n\r\n// 模块依赖映射\r\nexport const moduleDependencies: Record<string, string[]> = {\r\n  'uni-payment': [\r\n    'implementation \"com.alipay.sdk:alipaysdk-android:15.8.17\"',\r\n    'implementation \"com.tencent.mm.opensdk:wechat-sdk-android:6.8.0\"',\r\n  ],\r\n  'uni-location': [\r\n    'implementation \"com.tencent.map.geolocation:TencentLocationSdk-openplatform:7.5.4.3\"',\r\n  ],\r\n  'uni-map': [\r\n    'implementation \"com.tencent.map:tencent-map-vector-sdk:5.6.0\"',\r\n    'implementation \"com.tencent.map:sdk-utilities:1.0.9\"',\r\n  ],\r\n  'uni-push': [\r\n    'implementation \"com.getui:gtc-dcloud:3.2.16.7\"',\r\n    'implementation(\"com.getui:gtsdk:3.3.7.0\"){ exclude(group: \\'com.getui\\') }',\r\n  ],\r\n  'uni-camera': [\r\n    'implementation \"androidx.camera:camera-core:1.4.1\"',\r\n    'implementation \"androidx.camera:camera-camera2:1.4.1\"',\r\n    'implementation \"androidx.camera:camera-lifecycle:1.4.1\"',\r\n    'implementation \"androidx.camera:camera-view:1.4.1\"',\r\n  ],\r\n  'uni-video': [\r\n    'implementation \"com.google.android.exoplayer:exoplayer-core:2.18.0\"',\r\n  ],\r\n  'uni-scanCode': [\r\n    'implementation \"com.google.mlkit:barcode-scanning:17.2.0\"',\r\n  ],\r\n  'uni-canvas': [\r\n    // canvas 组件依赖\r\n  ],\r\n  'uni-ad': [\r\n    // 广告模块基础依赖\r\n  ],\r\n  'uni-live-player': [\r\n    'implementation \"com.qiniu:qplayer2-core:1.5.0\"',\r\n    'implementation \"com.qiniu:happy-dns:1.0.0\"',\r\n  ],\r\n  'uni-live-pusher': [\r\n    'implementation \"com.qiniu:qplayer2-core:1.5.0\"',\r\n  ],\r\n}\r\n","import fs from 'fs-extra'\r\nimport path from 'path'\r\nimport { fileURLToPath } from 'url'\r\nimport type { AppConfig } from '../types.js'\r\nimport { requiredDependencies, adDependencies, moduleDependencies } from '../config/dependencies.js'\r\n\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url))\r\n\r\n// SDK 模板路径 (相对于项目根目录)\r\nconst SDK_TEMPLATE_PATH = path.resolve(__dirname, '../../Android-uni-app-x-SDK@14196-4.87/uniappxnativepackage')\r\n\r\nexport async function generateProject(config: AppConfig): Promise<void> {\r\n  if (!config.projectInfo) {\r\n    throw new Error('项目信息不存在')\r\n  }\r\n\r\n  const { projectInfo, packageName, signing, adDependencies: selectedAds, hbuilderxPath } = config\r\n  const outputDir = path.resolve(process.cwd(), projectInfo.id)\r\n\r\n  // 1. 检查 SDK 模板是否存在\r\n  if (!await fs.pathExists(SDK_TEMPLATE_PATH)) {\r\n    throw new Error(`找不到 SDK 模板: ${SDK_TEMPLATE_PATH}`)\r\n  }\r\n\r\n  // 2. 复制 SDK 模板到输出目录\r\n  await fs.copy(SDK_TEMPLATE_PATH, outputDir, {\r\n    filter: (src) => {\r\n      // 排除 .DS_Store 和 .git 文件\r\n      const basename = path.basename(src)\r\n      return basename !== '.DS_Store' && basename !== '.git'\r\n    }\r\n  })\r\n\r\n  // 3. 复制 www 资源\r\n  const hbuilderxOutputPath = path.join(hbuilderxPath, 'unpackage', 'resources', 'app-android')\r\n  const wwwSourceDir = await findWwwDir(hbuilderxOutputPath)\r\n  if (wwwSourceDir) {\r\n    const wwwTargetDir = path.join(outputDir, 'uniappx', 'src', 'main', 'assets', 'apps', projectInfo.id, 'www')\r\n    await fs.ensureDir(path.dirname(wwwTargetDir))\r\n    await fs.copy(wwwSourceDir, wwwTargetDir)\r\n  }\r\n\r\n  // 4. 更新 app/build.gradle\r\n  await updateBuildGradle(outputDir, config)\r\n\r\n  // 5. 更新 strings.xml\r\n  await updateStringsXml(outputDir, projectInfo.name)\r\n\r\n  // 6. 复制图标\r\n  await copyIcons(hbuilderxOutputPath, outputDir, projectInfo.icons)\r\n\r\n  // 7. 更新 settings.gradle 中的项目名\r\n  await updateSettingsGradle(outputDir, projectInfo.id)\r\n}\r\n\r\nasync function findWwwDir(basePath: string): Promise<string | null> {\r\n  const entries = await fs.readdir(basePath, { withFileTypes: true })\r\n  for (const entry of entries) {\r\n    if (entry.isDirectory() && entry.name.startsWith('__UNI__')) {\r\n      const wwwDir = path.join(basePath, entry.name, 'www')\r\n      if (await fs.pathExists(wwwDir)) {\r\n        return wwwDir\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nasync function updateBuildGradle(outputDir: string, config: AppConfig): Promise<void> {\r\n  const buildGradlePath = path.join(outputDir, 'app', 'build.gradle')\r\n  let content = await fs.readFile(buildGradlePath, 'utf-8')\r\n\r\n  const { projectInfo, packageName, signing, adDependencies: selectedAds } = config\r\n\r\n  // 更新 applicationId\r\n  content = content.replace(\r\n    /applicationId\\s+\"[^\"]+\"/,\r\n    `applicationId \"${packageName}\"`\r\n  )\r\n\r\n  // 更新 versionCode\r\n  content = content.replace(\r\n    /versionCode\\s+\\d+/,\r\n    `versionCode ${projectInfo!.versionCode}`\r\n  )\r\n\r\n  // 更新 versionName\r\n  content = content.replace(\r\n    /versionName\\s+\"[^\"]+\"/,\r\n    `versionName \"${projectInfo!.versionName}\"`\r\n  )\r\n\r\n  // 添加签名配置\r\n  if (signing.keystorePath) {\r\n    const signingConfig = `\r\n    signingConfigs {\r\n        release {\r\n            storeFile file(\"${signing.keystorePath}\")\r\n            storePassword \"${signing.keystorePassword}\"\r\n            keyAlias \"${signing.keyAlias}\"\r\n            keyPassword \"${signing.keyPassword}\"\r\n        }\r\n    }\r\n`\r\n    // 在 android { 后面插入签名配置\r\n    content = content.replace(\r\n      /(android\\s*\\{)/,\r\n      `$1\\n${signingConfig}`\r\n    )\r\n\r\n    // 在 buildTypes release 中添加签名配置引用\r\n    content = content.replace(\r\n      /(buildTypes\\s*\\{\\s*release\\s*\\{)/,\r\n      `$1\\n            signingConfig signingConfigs.release`\r\n    )\r\n  }\r\n\r\n  // 生成依赖列表\r\n  const dependencies: string[] = [...requiredDependencies]\r\n\r\n  // 添加模块依赖\r\n  for (const module of projectInfo!.modules) {\r\n    const moduleDeps = moduleDependencies[module]\r\n    if (moduleDeps) {\r\n      dependencies.push(...moduleDeps)\r\n    }\r\n  }\r\n\r\n  // 添加广告依赖\r\n  for (const ad of selectedAds) {\r\n    if (ad.selected) {\r\n      const adDeps = adDependencies[ad.id]\r\n      if (adDeps) {\r\n        dependencies.push(...adDeps)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 去重\r\n  const uniqueDeps = [...new Set(dependencies)]\r\n\r\n  // 在 dependencies 块中添加依赖 (保留原有的 implementation project)\r\n  const depsString = uniqueDeps.map(dep => `    ${dep}`).join('\\n')\r\n  content = content.replace(\r\n    /(dependencies\\s*\\{)/,\r\n    `$1\\n${depsString}\\n`\r\n  )\r\n\r\n  await fs.writeFile(buildGradlePath, content)\r\n}\r\n\r\nasync function updateStringsXml(outputDir: string, appName: string): Promise<void> {\r\n  const stringsXmlPath = path.join(outputDir, 'app', 'src', 'main', 'res', 'values', 'strings.xml')\r\n  let content = await fs.readFile(stringsXmlPath, 'utf-8')\r\n\r\n  content = content.replace(\r\n    /<string name=\"app_name\">[^<]+<\\/string>/,\r\n    `<string name=\"app_name\">${appName}</string>`\r\n  )\r\n\r\n  await fs.writeFile(stringsXmlPath, content)\r\n}\r\n\r\nasync function copyIcons(sourcePath: string, outputDir: string, icons: Record<string, string>): Promise<void> {\r\n  const iconDensityMap: Record<string, string> = {\r\n    hdpi: 'mipmap-hdpi',\r\n    xhdpi: 'mipmap-xhdpi',\r\n    xxhdpi: 'mipmap-xxhdpi',\r\n    xxxhdpi: 'mipmap-xxxhdpi',\r\n  }\r\n\r\n  for (const [density, iconPath] of Object.entries(icons)) {\r\n    const targetDensity = iconDensityMap[density]\r\n    if (targetDensity) {\r\n      // 查找源图标\r\n      const sourceIconPath = await findIconFile(sourcePath, iconPath)\r\n      if (sourceIconPath) {\r\n        const targetDir = path.join(outputDir, 'app', 'src', 'main', 'res', targetDensity)\r\n        await fs.ensureDir(targetDir)\r\n        await fs.copy(sourceIconPath, path.join(targetDir, 'ic_launcher.png'))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nasync function findIconFile(basePath: string, iconPath: string): Promise<string | null> {\r\n  // 尝试在 package 目录下查找\r\n  const entries = await fs.readdir(basePath, { withFileTypes: true })\r\n  for (const entry of entries) {\r\n    if (entry.isDirectory() && entry.name.startsWith('__UNI__')) {\r\n      const fullIconPath = path.join(basePath, entry.name, iconPath)\r\n      if (await fs.pathExists(fullIconPath)) {\r\n        return fullIconPath\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nasync function updateSettingsGradle(outputDir: string, projectId: string): Promise<void> {\r\n  const settingsGradlePath = path.join(outputDir, 'settings.gradle')\r\n  let content = await fs.readFile(settingsGradlePath, 'utf-8')\r\n\r\n  content = content.replace(\r\n    /rootProject\\.name\\s*=\\s*\"[^\"]+\"/,\r\n    `rootProject.name = \"${projectId}\"`\r\n  )\r\n\r\n  await fs.writeFile(settingsGradlePath, content)\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Box, Text } from 'ink'\r\nimport type { AppStep, AppConfig, ProjectInfo, AdDependency } from './types.js'\r\nimport { Menu } from './components/Menu.js'\r\nimport { Input } from './components/Input.js'\r\nimport { MultiSelect } from './components/MultiSelect.js'\r\nimport { ProjectInfoDisplay } from './components/ProjectInfo.js'\r\nimport { parseProject } from './services/parser.js'\r\nimport { generateProject } from './services/generator.js'\r\n\r\nconst initialAdDependencies: AdDependency[] = [\r\n  { id: 'huawei', name: '华为广告', selected: false },\r\n  { id: 'csj', name: '穿山甲广告', selected: false },\r\n  { id: 'gdt', name: '优量汇广告', selected: false },\r\n  { id: 'ks', name: '快手广告', selected: false },\r\n  { id: 'baidu', name: '百度广告', selected: false },\r\n  { id: 'sigmob', name: 'Sigmob广告', selected: false },\r\n  { id: 'unity', name: 'Unity广告', selected: false },\r\n  { id: 'vungle', name: 'Vungle广告', selected: false },\r\n  { id: 'mintegral', name: 'Mintegral广告', selected: false },\r\n  { id: 'ironsource', name: 'IronSource广告', selected: false },\r\n]\r\n\r\nconst initialConfig: AppConfig = {\r\n  hbuilderxPath: '',\r\n  projectInfo: null,\r\n  packageName: '',\r\n  adDependencies: initialAdDependencies,\r\n  signing: {\r\n    keystorePath: '',\r\n    keystorePassword: '',\r\n    keyAlias: '',\r\n    keyPassword: '',\r\n  },\r\n}\r\n\r\nexport function App() {\r\n  const [step, setStep] = useState<AppStep>('menu')\r\n  const [config, setConfig] = useState<AppConfig>(initialConfig)\r\n  const [error, setError] = useState<string>('')\r\n  const [signingStep, setSigningStep] = useState<number>(0)\r\n\r\n  const handleMenuSelect = (index: number) => {\r\n    if (index === 0) {\r\n      // 创建新项目\r\n      setStep('input-path')\r\n    } else if (index === 1) {\r\n      // 从现有项目更新 (暂时同创建新项目)\r\n      setStep('input-path')\r\n    } else {\r\n      // 退出\r\n      process.exit(0)\r\n    }\r\n  }\r\n\r\n  const handlePathSubmit = async (path: string) => {\r\n    setError('')\r\n    try {\r\n      const projectInfo = await parseProject(path)\r\n      setConfig(prev => ({\r\n        ...prev,\r\n        hbuilderxPath: path,\r\n        projectInfo,\r\n        packageName: `com.example.${projectInfo.id.toLowerCase().replace(/__/g, '').replace(/_/g, '')}`,\r\n      }))\r\n      setStep('project-info')\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : '解析项目失败')\r\n    }\r\n  }\r\n\r\n  const handleProjectInfoConfirm = () => {\r\n    setStep('input-package')\r\n  }\r\n\r\n  const handlePackageSubmit = (packageName: string) => {\r\n    setConfig(prev => ({ ...prev, packageName }))\r\n    setStep('select-ads')\r\n  }\r\n\r\n  const handleAdsSelect = (ads: AdDependency[]) => {\r\n    setConfig(prev => ({ ...prev, adDependencies: ads }))\r\n    setStep('input-signing')\r\n    setSigningStep(0)\r\n  }\r\n\r\n  const handleSigningInput = (value: string) => {\r\n    const fields = ['keystorePath', 'keystorePassword', 'keyAlias', 'keyPassword'] as const\r\n    setConfig(prev => ({\r\n      ...prev,\r\n      signing: { ...prev.signing, [fields[signingStep]]: value },\r\n    }))\r\n\r\n    if (signingStep < 3) {\r\n      setSigningStep(signingStep + 1)\r\n    } else {\r\n      setStep('confirm')\r\n    }\r\n  }\r\n\r\n  const handleConfirm = async (index: number) => {\r\n    if (index === 0) {\r\n      // 确认生成\r\n      setStep('generating')\r\n      try {\r\n        await generateProject(config)\r\n        setStep('done')\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err.message : '生成项目失败')\r\n        setStep('confirm')\r\n      }\r\n    } else if (index === 1) {\r\n      // 返回修改\r\n      setStep('input-path')\r\n    } else {\r\n      // 取消\r\n      process.exit(0)\r\n    }\r\n  }\r\n\r\n  const handleBack = () => {\r\n    const stepOrder: AppStep[] = [\r\n      'menu', 'input-path', 'project-info', 'input-package',\r\n      'select-ads', 'input-signing', 'confirm'\r\n    ]\r\n    const currentIndex = stepOrder.indexOf(step)\r\n    if (currentIndex > 0) {\r\n      if (step === 'input-signing' && signingStep > 0) {\r\n        setSigningStep(signingStep - 1)\r\n      } else {\r\n        setStep(stepOrder[currentIndex - 1])\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box flexDirection=\"column\" padding={1}>\r\n      <Box marginBottom={1}>\r\n        <Text bold color=\"cyan\">\r\n          ┌─────────────────────────────────────────┐\r\n        </Text>\r\n      </Box>\r\n      <Box marginBottom={1}>\r\n        <Text bold color=\"cyan\">\r\n          │  ANX - uni-app-x Android 离线打包工具   │\r\n        </Text>\r\n      </Box>\r\n      <Box marginBottom={1}>\r\n        <Text bold color=\"cyan\">\r\n          └─────────────────────────────────────────┘\r\n        </Text>\r\n      </Box>\r\n\r\n      {error && (\r\n        <Box marginBottom={1}>\r\n          <Text color=\"red\">错误: {error}</Text>\r\n        </Box>\r\n      )}\r\n\r\n      {step === 'menu' && (\r\n        <Menu\r\n          items={['创建新项目', '从现有项目更新', '退出']}\r\n          onSelect={handleMenuSelect}\r\n        />\r\n      )}\r\n\r\n      {step === 'input-path' && (\r\n        <Input\r\n          label=\"请输入 HBuilderX 项目路径\"\r\n          placeholder=\"/path/to/your/uniapp-project\"\r\n          onSubmit={handlePathSubmit}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'project-info' && config.projectInfo && (\r\n        <ProjectInfoDisplay\r\n          info={config.projectInfo}\r\n          onConfirm={handleProjectInfoConfirm}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'input-package' && (\r\n        <Input\r\n          label=\"请输入包名 (applicationId)\"\r\n          defaultValue={config.packageName}\r\n          onSubmit={handlePackageSubmit}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'select-ads' && (\r\n        <MultiSelect\r\n          label=\"选择广告依赖（空格选择，jk 上下移动，Enter 确认）\"\r\n          items={config.adDependencies}\r\n          onSubmit={handleAdsSelect}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'input-signing' && (\r\n        <Input\r\n          label={\r\n            signingStep === 0 ? 'keystore 路径' :\r\n            signingStep === 1 ? 'keystore 密码' :\r\n            signingStep === 2 ? 'key 别名' : 'key 密码'\r\n          }\r\n          isPassword={signingStep === 1 || signingStep === 3}\r\n          onSubmit={handleSigningInput}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'confirm' && (\r\n        <Menu\r\n          items={['确认生成', '返回修改', '取消']}\r\n          onSelect={handleConfirm}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {step === 'generating' && (\r\n        <Text color=\"yellow\">正在生成项目...</Text>\r\n      )}\r\n\r\n      {step === 'done' && (\r\n        <Box flexDirection=\"column\">\r\n          <Text color=\"green\">✓ 项目已生成到: ./{config.projectInfo?.id}</Text>\r\n          <Text dimColor>按任意键退出</Text>\r\n        </Box>\r\n      )}\r\n\r\n      <Box marginTop={1}>\r\n        <Text dimColor>操作: jk 上下 | 空格 多选 | Enter 确认 | b 返回</Text>\r\n      </Box>\r\n    </Box>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { render } from 'ink'\r\nimport { App } from './app.js'\r\n\r\nrender(<App />)\r\n"],"names":["__dirname","path"],"mappings":"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"}